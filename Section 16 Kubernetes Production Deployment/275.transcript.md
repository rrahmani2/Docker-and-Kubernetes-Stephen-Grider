### Verifying Cluster Access and Creating the Postgres Secret

After configuring the `gcloud` CLI in the Cloud Shell, verify that you’re connected to the remote Kubernetes cluster and then create the **Postgres password secret** needed by your deployments.

---

#### 1. Verify Cluster Connection

Run the following command in **Google Cloud Shell**:

```bash
kubectl get pods
```

Expected output:

```
No resources found
```

This confirms that `kubectl` is properly connected to your cluster — even though no pods exist yet, the command response verifies successful communication with the Kubernetes API.

---

#### 2. Create the Secret for Postgres

Next, create the Kubernetes secret that stores your Postgres password.
The secret name **must** match what is referenced in the `server-deployment.yaml` file — in this case, `pgpassword` (all lowercase).

Run:

```bash
kubectl create secret generic pgpassword --from-literal PGPASSWORD=<your_password>
```

Example:

```bash
kubectl create secret generic pgpassword --from-literal PGPASSWORD=myPGpassword123
```

**Explanation:**

* `create secret generic` → creates a secret resource.
* `pgpassword` → name of the secret (must match your deployment config).
* `--from-literal` → defines key-value pairs directly in the command.
* `PGPASSWORD` → key used by the multi-server and Postgres containers.
* `<your_password>` → your chosen password (does not need to match local dev credentials).

---

#### 3. Confirm the Secret Exists

After creation, verify the secret:

```bash
kubectl get secrets
```

Expected to list something like:

```
NAME          TYPE                 DATA   AGE
pgpassword    Opaque               1      5s
```

You can inspect it further (keys only, not raw values) using:

```bash
kubectl describe secret pgpassword
```

---

#### 4. Verify in the Cloud Console (Optional)

If you refresh the **Configuration** tab in your Google Cloud Console Kubernetes dashboard, the `pgpassword` secret will now appear under **Secrets**, confirming it’s available for your deployments.

---

#### ✅ Summary

| Step              | Command                                                                              | Purpose                                     |
| ----------------- | ------------------------------------------------------------------------------------ | ------------------------------------------- |
| Verify connection | `kubectl get pods`                                                                   | Confirms Cloud Shell `kubectl` is connected |
| Create secret     | `kubectl create secret generic pgpassword --from-literal PGPASSWORD=<your_password>` | Defines Postgres password                   |
| Verify secret     | `kubectl get secrets`                                                                | Confirms successful creation                |

The Kubernetes cluster is now fully configured with the necessary `pgpassword` secret and ready for deployment.
