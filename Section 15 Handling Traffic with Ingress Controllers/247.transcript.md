### Ingress-NGINX Routing Configuration (Local Setup)

#### Objective

Define routing rules for the local Kubernetes application using **Ingress-NGINX**, replicating the routing logic used in the earlier Elastic Beanstalk project.

Routing logic:

* Requests starting with `/api` → forwarded to **server** service.
* All other requests → forwarded to **client** service.

---

#### 1. Create Ingress Configuration File

Create a new YAML file inside the Kubernetes manifests directory:

```bash
cd k8s
nano ingress-service.yaml
```

---

#### 2. Ingress YAML Definition

```yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: ingress-service
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
    - http:
        paths:
          - path: /
            backend:
              serviceName: client-cluster-ip-service
              servicePort: 3000
          - path: /api/
            backend:
              serviceName: server-cluster-ip-service
              servicePort: 5000
```

---

#### 3. Explanation

**Metadata**

* `annotations` define how the ingress behaves and which controller handles it:

  * `kubernetes.io/ingress.class: nginx` → tells Kubernetes to use the NGINX ingress controller.
  * `nginx.ingress.kubernetes.io/rewrite-target: /` → rewrites URLs to strip `/api` from incoming requests before they reach the server, decoupling backend routes from frontend routing logic.

**Spec → Rules**

* Defines routing behavior for different URL paths:

  * `/` → directs to `client-cluster-ip-service` on port `3000`.
  * `/api/` → directs to `server-cluster-ip-service` on port `5000`.
* These rules let NGINX forward traffic to internal cluster services **without specifying IPs** — service names act as internal DNS entries.

**Behavior Summary**

* Requests with `/api` prefix → routed to backend API pods.
* All other requests → routed to frontend client pods.
* Ingress controller automatically resolves service endpoints.

---

#### 4. Apply Configuration

Deploy the ingress configuration to the cluster:

```bash
kubectl apply -f k8s/
```

Expected output:

```
ingress-service created
```

---

#### 5. Next Step

Verify that the **Ingress controller** is active and routing traffic correctly. Further modifications and additional rules will be introduced later as the setup evolves.
