### Creating a ClusterIP Service for the Multi-Client Deployment

**Objective:**
Define a **ClusterIP service** to expose the multi-client pods internally within the Kubernetes cluster.

---

### 1. File Setup

* Create a new file inside the `k8s` directory:
  **`client-cluster-ip-service.yaml`**

---

### 2. Service Configuration

The ClusterIP configuration closely resembles a NodePort service, except it omits the external access field (`nodePort`).

```yaml
apiVersion: v1
kind: Service
metadata:
  name: client-cluster-ip-service
spec:
  type: ClusterIP
  selector:
    component: web
  ports:
    - port: 3000
      targetPort: 3000
```

---

### 3. Configuration Breakdown

| Section                     | Purpose                                                                                         |
| --------------------------- | ----------------------------------------------------------------------------------------------- |
| **apiVersion: v1**          | Uses the core Kubernetes API for services.                                                      |
| **kind: Service**           | Declares this resource as a Kubernetes Service object.                                          |
| **metadata.name**           | Names the service `client-cluster-ip-service`.                                                  |
| **spec.type: ClusterIP**    | Specifies internal-only access within the cluster.                                              |
| **selector.component: web** | Matches pods labeled `component: web` (as defined in the client deployment).                    |
| **ports.port**              | The port other internal services will use to reach the client pods.                             |
| **ports.targetPort**        | The port on the target container that receives the traffic (port 3000 in the client container). |

---

### 4. Key Notes

* **No `nodePort` field** â€” this service is **not accessible externally**.
* `port` and `targetPort` can differ if internal routing needs translation, but here both are **3000** for consistency.
* This setup allows internal services (e.g., API, Redis, workers) to communicate with the multi-client pods using the service name (`client-cluster-ip-service`) and port 3000.

---

### 5. Outcome

This configuration enables internal cluster access to the multi-client deployment while keeping it isolated from external users. External access will later be handled by the **Ingress service**.
