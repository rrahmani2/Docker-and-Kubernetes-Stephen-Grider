### Persistent Volume Claim (PVC) – Technical Notes

#### 1. Recap

* A **PersistentVolumeClaim (PVC)** is **not** actual storage — it’s a **request** for storage that a **Pod** can use.
* The PVC advertises storage options (e.g., “500 GB” or “1 TB”).
* When a **Pod** referencing a PVC is created, Kubernetes:

  1. Reads the PVC request.
  2. Attempts to **bind** the claim to an existing **PersistentVolume (PV)** that meets the request.
  3. If no matching PV exists and **dynamic provisioning** is enabled, Kubernetes creates a new PV automatically.

---

#### 2. PVC Structure

Key YAML configuration fields:

```yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: database-persistent-volume-claim
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
```

---

#### 3. Explanation of `spec` Fields

##### a. `accessModes`

Defines how the volume can be accessed. Supported modes:

| Mode                    | Description                                |
| ----------------------- | ------------------------------------------ |
| **ReadWriteOnce (RWO)** | Mounted as read/write by a single node.    |
| **ReadOnlyMany (ROX)**  | Multiple nodes can mount it as read-only.  |
| **ReadWriteMany (RWX)** | Multiple nodes can mount it as read/write. |

> The access mode dictates what type of underlying storage Kubernetes must find or provision.
> For example, `ReadWriteOnce` requires a storage type that supports single-node read/write access.

---

##### b. `resources.requests.storage`

Specifies the **exact size** of storage requested by the PVC.

* Example: `2Gi` → Kubernetes must find or provision **exactly 2 GB** of storage.
* Values can be adjusted (e.g., `500Gi`, `1Ti`) as needed for application requirements.
* In this example, 2 GB is more than enough for a simple PostgreSQL database.

---

#### 4. Behavior Summary

* When the Pod using this PVC is deployed:

  * Kubernetes searches for a **PV** matching both `accessModes` and `storage` size.
  * If none exist and dynamic provisioning is configured, a **new PV** is created to fulfill the request.
* The claim ensures consistent and declarative storage allocation across Pods.

---

#### 5. Upcoming Configuration Options

Additional optional fields (not included here but commonly used):

* `storageClassName` – defines which **StorageClass** to use for dynamic provisioning.
* `volumeMode` – specifies whether the volume should be **Filesystem** or **Block**.
* `selector` – filters which PVs are eligible to bind using label matching.

These will be covered next for deeper control over how Kubernetes provisions and binds storage.
