### PersistentVolumeClaim Configuration — Breakdown

This section introduces how to **define a PersistentVolumeClaim (PVC)** in Kubernetes. The PVC advertises a specific storage request that can later be attached to a Pod.

---

#### **1. Purpose**

* A **PersistentVolumeClaim** represents a **request for storage** by a Pod.
* It specifies how much storage is needed and what kind of access mode should be granted.
* When Kubernetes receives this claim, it tries to:

  1. Match it with an existing PersistentVolume (PV) that satisfies the request, **or**
  2. Dynamically create a new PV to fulfill the claim.

---

#### **2. File Path**

Create a file inside your Kubernetes configuration directory (usually `k8s/`):

```
k8s/database-persistent-volume-claim.yaml
```

---

#### **3. YAML Configuration**

```yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: database-persistent-volume-claim
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
```

---

#### **4. Explanation of Each Field**

| Field                               | Description                                                                                                                                                                                                                       |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **apiVersion: v1**                  | The Kubernetes API version for PVC objects.                                                                                                                                                                                       |
| **kind: PersistentVolumeClaim**     | Defines the resource type as a persistent volume claim.                                                                                                                                                                           |
| **metadata.name**                   | The name that uniquely identifies the PVC in the cluster.                                                                                                                                                                         |
| **spec.accessModes**                | Defines how the volume can be mounted: <br>• `ReadWriteOnce` – mounted by a single node with read/write access. <br>• `ReadOnlyMany` – mounted read-only by many nodes. <br>• `ReadWriteMany` – mounted read/write by many nodes. |
| **spec.resources.requests.storage** | Specifies the amount of storage requested (2Gi in this example).                                                                                                                                                                  |

---

#### **5. What Happens Internally**

1. When this YAML is applied (`kubectl apply -f k8s/`):

   * Kubernetes looks for an existing PV with **≥2Gi capacity** and **ReadWriteOnce** access.
2. If a matching PV exists → it **binds** to the PVC.
3. If not → Kubernetes will try to **dynamically provision** one (if a `StorageClass` is configured).

---

#### **6. Outcome**

Once applied, the cluster will have a **PersistentVolumeClaim** named `database-persistent-volume-claim`.
Any Pod that references this claim in its spec will get attached to a volume that satisfies this request — either pre-existing or dynamically created.

---

This PVC forms the storage foundation that the upcoming **Postgres Pod** will use to persist database data even across Pod restarts or recreations.
