### Redis Deployment and ClusterIP Service Configuration

**Objective:**
Deploy a single Redis instance in Kubernetes and expose it internally via a ClusterIP service.

---

### 1. Files to Create

Inside the `k8s/` directory, create the following files:

```
redis-deployment.yaml
redis-cluster-ip-service.yaml
```

---

### 2. Redis Deployment Configuration

**File:** `redis-deployment.yaml`

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: redis-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      component: redis
  template:
    metadata:
      labels:
        component: redis
    spec:
      containers:
        - name: redis
          image: redis
          ports:
            - containerPort: 6379
```

**Explanation:**

* **replicas: 1** — runs a single Redis pod.
* **selector / labels** — match pods labeled `component: redis`.
* **image: redis** — uses the official Redis image from Docker Hub (no custom image).
* **containerPort: 6379** — exposes Redis’s default port.

> Redis can operate in clustered mode for scalability, but for simplicity, this setup uses a single standalone instance.

---

### 3. Redis ClusterIP Service Configuration

**File:** `redis-cluster-ip-service.yaml`

```yaml
apiVersion: v1
kind: Service
metadata:
  name: redis-cluster-ip-service
spec:
  type: ClusterIP
  selector:
    component: redis
  ports:
    - port: 6379
      targetPort: 6379
```

**Explanation:**

* **type: ClusterIP** — exposes Redis **internally** within the cluster.
* **selector:** links the service to pods with label `component: redis`.
* **port / targetPort:** both set to **6379**, since Redis listens on that port by default.

---

### 4. Apply Configuration

Execute:

```bash
kubectl apply -f k8s/
```

**Expected Output:**

* Existing objects: *unchanged*
* New objects:

  * `redis-deployment` → *created*
  * `redis-cluster-ip-service` → *created*

---

### 5. Verification

Check pods:

```bash
kubectl get pods
```

Expected:

```
redis-deployment-xxxxxxx   1/1   Running
```

Check services:

```bash
kubectl get services
```

Expected:

```
redis-cluster-ip-service   ClusterIP   <IP>   <none>   6379/TCP
```

---

### 6. Summary

| Component | Type       | Service Type | Port | Purpose                                                               |
| --------- | ---------- | ------------ | ---- | --------------------------------------------------------------------- |
| **Redis** | Deployment | ClusterIP    | 6379 | In-memory key-value store for caching and inter-service communication |

---

### 7. Next Step

Next, create and deploy the **Postgres Deployment** and its **ClusterIP Service**, completing the database layer setup.
