**Synopsis: Setting Up the Express API Server (Redis + Postgres Integration)**

---

### **1. Purpose of This Section**

* Begin developing the **Express API server** for the multi-container Fibonacci app.
* This server acts as the **backend API layer**, handling communication between:

  * The **React frontend**
  * The **Postgres database** (for persistence)
  * The **Redis store** (for caching and worker communication).
* Focus here is on setting up the **project structure** and configuration files — no routes or logic yet.

---

### **2. Directory Structure Setup**

1. Navigate to the root of your project (same level as `worker/`).
2. Create a **new folder named `server/`**.
3. Ensure the `server/` directory is **a sibling** of `worker/`, not nested inside it.

Final structure should look like:

```
complex/
  ├── worker/
  └── server/
```

---

### **3. Create `package.json` for the Server**

Inside `server/`, create `package.json` with the following dependencies and scripts:

```json
{
  "dependencies": {
    "express": "4.16.3",
    "pg": "7.4.3",
    "redis": "2.8.0",
    "cors": "2.8.4",
    "nodemon": "1.18.3"
  },
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon"
  }
}
```

**Notes:**

* Use **double quotes** for all keys and values.
* Include commas properly — a missing or extra comma will break parsing.
* `nodemon` is for hot reloading in development mode.
* Each dependency plays a specific role:

  * **express** → builds the API server.
  * **pg** → connects to Postgres.
  * **redis** → connects to Redis.
  * **cors** → handles cross-origin requests from React.
  * **nodemon** → monitors file changes during development.

---

### **4. Create the `keys.js` Configuration File**

Inside `server/`, create a new file named **`keys.js`**.
This file centralizes all configuration values — mostly environment variables.

```js
module.exports = {
  redisHost: process.env.REDIS_HOST,
  redisPort: process.env.REDIS_PORT,
  pgUser: process.env.PG_USER,
  pgHost: process.env.PG_HOST,
  pgDatabase: process.env.PG_DATABASE,
  pgPassword: process.env.PG_PASSWORD,
  pgPort: process.env.PG_PORT
};
```

**Checklist:**

* All environment variable names (`REDIS_HOST`, `PG_USER`, etc.) must be **capitalized**.
* Left-hand property names (`redisHost`, `pgUser`, etc.) must match how you’ll reference them later in code.
* You should have **seven** entries in total.

---

### **5. Key Takeaways**

* The Express server will serve as the **API layer** connecting all system components.
* Proper configuration through environment variables ensures flexibility and Docker compatibility later.
* Any typo in `keys.js` will cause **runtime connection issues**, so double-check every line now.

---

### **6. Next Step**

In the upcoming section, you’ll:

* Implement **Express server logic**.
* Establish connections to both **Redis** and **Postgres**.
* Start defining **API endpoints** for reading/writing Fibonacci data.
