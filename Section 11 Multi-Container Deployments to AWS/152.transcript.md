This section is continuing the `Dockerrun.aws.json` setup and explaining **how to finish defining the non-essential containers** (client, server/API, worker) before creating the final essential one (NGINX).

Here’s the breakdown of what’s really happening — conceptually and syntactically.

---

## 1. **Adding the `essential` Flag**

Each container definition in `Dockerrun.aws.json` can include:

```json
"essential": true | false
```

This flag tells **Elastic Beanstalk (and ECS under the hood)** how to behave if the container crashes.

* `"essential": true` → if this container dies, **all containers** in the task stop.
* `"essential": false` → if this container dies, **other containers keep running.**

At least **one container** in the group must be essential.

So:

* ✅ NGINX → essential: `true`
* ❌ client, server(API), worker → essential: `false`

---

## 2. **Client Definition (Complete)**

```json
{
  "name": "client",
  "image": "your-dockerhub-id/multi-client",
  "hostname": "client",
  "essential": false
}
```

Explanation:

* The web front-end.
* Not essential — if it crashes, the rest of the app still functions.

---

## 3. **Server (API) Definition**

```json
{
  "name": "server",
  "image": "your-dockerhub-id/multi-server",
  "hostname": "api",
  "essential": false
}
```

Explanation:

* This is the Express backend (renamed to `api` in NGINX routing).
* Not essential — app can still serve the static frontend.

---

## 4. **Worker Definition**

```json
{
  "name": "worker",
  "image": "your-dockerhub-id/multi-worker",
  "hostname": "worker",
  "essential": false
}
```

Explanation:

* Background computation container.
* If it dies, users can still interact with the site — they just won’t get new computed results.

---

## 5. **Status So Far**

At this point, your `Dockerrun.aws.json` looks like this (before adding NGINX):

```json
{
  "AWSEBDockerrunVersion": 2,
  "containerDefinitions": [
    {
      "name": "client",
      "image": "your-dockerhub-id/multi-client",
      "hostname": "client",
      "essential": false
    },
    {
      "name": "server",
      "image": "your-dockerhub-id/multi-server",
      "hostname": "api",
      "essential": false
    },
    {
      "name": "worker",
      "image": "your-dockerhub-id/multi-worker",
      "hostname": "worker",
      "essential": false
    }
  ]
}
```

---

Next, the tutorial will add **the NGINX container**, which:

* Uses the image `your-dockerhub-id/multi-nginx`
* Will expose port 80
* Will be marked as `"essential": true`
* Will link to the `client` and `api` containers (for routing)

Would you like me to show the **final `Dockerrun.aws.json`** including the NGINX configuration with ports and links so you can see how everything fits together?
