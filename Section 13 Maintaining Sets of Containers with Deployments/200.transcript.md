# **Tutor Notes — Updating the Docker Image for a Kubernetes Deployment**

## Objective

Simulate an image update workflow by **modifying source code**, **rebuilding the image**, and **pushing it to Docker Hub**, preparing for the deployment to pull the latest version.

---

## Step 1: Context

In the previous section, the deployment was switched back to use the `multi-client` image.
Now, the goal is to:

1. Modify the **multi-client** React app source code.
2. **Rebuild** the Docker image.
3. **Push** the updated image to Docker Hub.

---

## Step 2: Navigate to the Multi-Container Project

From the terminal:

```bash
cd path/to/complex
```

Then open the client directory, which contains the **multi-client** code:

```bash
cd client
```

Open the project in a code editor:

```bash
code .
```

> The `client` folder contains the source for the **multi-client** React application used in the Kubernetes deployment.

---

## Step 3: Modify the Source Code

Path to modify:

```
client/src/App.js
```

Inside the `render()` method, locate the `<h1>` tag:

```javascript
<h1>Fib Calculator</h1>
```

Update it to clearly indicate a new version:

```javascript
<h1>Fib Calculator version 2</h1>
```

This ensures a **visible change in the browser**, confirming when the updated image is deployed.

Save and close the file.

---

## Step 4: Rebuild the Docker Image

Ensure you are still inside the `client` directory, then build the updated image:

```bash
docker build -t <docker-id>/multi-client .
```

Explanation:

* `-t <docker-id>/multi-client` → tags the image for Docker Hub.
* `.` → specifies the current directory as the build context.

> The rebuild is necessary since source code changes invalidate the previous image layers.

---

## Step 5: Push the New Image to Docker Hub

After the build completes successfully:

```bash
docker push <docker-id>/multi-client
```

This uploads the updated image to your Docker Hub repository, replacing or versioning the previous one (depending on tag strategy).

---

## Step 6: Verification and Next Step

At this stage:

* **Docker Hub** now hosts the latest version of the `multi-client` image.
* The **Kubernetes deployment** still references the older image version currently in use by its pods.

Next, the task is to:

> Trigger the deployment to pull and use the newly pushed image across all managed pods.

---

### Key Takeaways

| Concept                | Explanation                                                                      |
| ---------------------- | -------------------------------------------------------------------------------- |
| **Source code change** | Simple text modification ensures visible confirmation of new image deployment.   |
| **Docker rebuild**     | Recompiles the image with updated application files.                             |
| **Docker push**        | Publishes the latest image version to Docker Hub.                                |
| **Deployment sync**    | The next step involves updating Kubernetes to recreate pods using the new image. |
