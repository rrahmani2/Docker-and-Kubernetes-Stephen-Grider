### Understanding Docker Clients and Servers in Kubernetes — Tutor Notes

#### Objective

Explain why multiple Docker containers appear when running `docker ps` in some terminals, and how Docker clients can connect to different Docker servers (local vs. inside the Kubernetes VM).

---

### Key Concepts

#### 1. Two Docker Environments Exist

When using Kubernetes locally (e.g., via **Minikube**), you effectively have **two separate Docker environments**:

* **Local Docker (Host)** — Installed via Docker Desktop or Docker for Mac/Windows.

  * Managed through the system tray icon.
  * Containers here are started manually or through local Docker commands.

* **Kubernetes Node Docker (VM)** — Runs **inside the Minikube virtual machine**.

  * Used by Kubernetes to create and manage containers defined in pods and deployments.

---

### 2. Communication Flow Recap

When a deployment or pod configuration is applied:

1. `kubectl apply -f <file>` sends the spec to the **Kubernetes master**.
2. The master instructs the **node (VM)** to create the pod.
3. Inside the node:

   * The **Docker client** requests the **Docker server** to:

     * Pull the specified image from Docker Hub.
     * Create and start a container.

Thus, Kubernetes uses the **Docker instance inside the Minikube VM**, not the one installed on your host.

---

### 3. Why `docker ps` Shows Different Results

* Running `docker ps` in a normal terminal shows containers managed by **your local Docker server** — usually **none** or a few test containers.
* Running `docker ps` in another terminal configured to connect to **Minikube’s Docker server** shows **many containers**, including:

  * Kubernetes system pods (e.g., kube-proxy, CoreDNS, etc.)
  * Your deployed application containers (e.g., `multi-client`)

This difference occurs because both terminals’ Docker clients are communicating with **different Docker servers**.

---

### 4. How Docker Client Connections Work

Each terminal session’s Docker client (`docker CLI`) can be configured to communicate with **different Docker servers** by setting environment variables like `DOCKER_HOST`.

* **Default terminal:** connects to the **local Docker server**.
* **Reconfigured terminal:** can connect to the **Docker server inside the Minikube VM**.

Example concept:

```
[ Terminal A ] → Local Docker Server (Docker Desktop)
[ Terminal B ] → Minikube VM Docker Server
```

Hence:

* `docker ps` in Terminal A → shows few or no containers.
* `docker ps` in Terminal B → lists all Kubernetes-managed containers.

---

### Summary

* Two Docker servers exist:

  1. Host Docker (installed manually)
  2. VM Docker (inside Minikube, used by Kubernetes)
* The `docker CLI` connects to one server at a time, depending on configuration.
* Kubernetes uses the **VM’s Docker server** to manage all pods and deployments.
* Understanding this separation clarifies why `docker ps` outputs differ across terminals.
